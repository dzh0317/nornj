/*!
* NornJ template engine v5.0.0-beta.7
* (c) 2016-2019 Joe_Sky
* Released under the MIT License.
*/
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).NornJ={})}(this,function(e){"use strict";function a(){return a["taggedTmpl"+(a.outputH?"H":"")].apply(null,arguments)}function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}a.createElement=null,a.components={},a.componentConfig=new Map,a.preAsts={},a.asts={},a.templates={},a.errorTitle="[NornJ]",a.tmplRule={},a.outputH=!1,a.global="undefined"!=typeof self?self:global,a.textTag="nj-text",a.textMode=!1,a.noWsTag="nj-noWs",a.noWsMode=!1;var r=Array.prototype.push,o=Array.prototype.slice,l=Object.prototype.hasOwnProperty,n=Object.prototype.toString,i=a.errorTitle,u=Object.defineProperty,p=Object.defineProperties;function f(e,n){return r.apply(e,n),e}function c(e,n,t){return o.call(e,n,t)}function v(e){return Array.isArray(e)}function d(e){var n=t(e);return!v(e)&&("function"===n||"object"===n&&!!e)}function m(e){return"[object Number]"===n.call(e)}function y(e){return"[object String]"===n.call(e)}var b,x=(b="length",function(e){return null==e?void 0:e[b]});function g(e){var n=x(e);return"number"==typeof n&&0<=n}function j(e,n,t,r){if(e)if(null==r&&(r=g(e)),t=t||e,r)for(var o=0,l=e.length;o<l;o++){if(!1===n.call(t,e[o],o,l))break}else for(var i=Object.keys(e),u=i.length,a=0;a<u;a++){var s=i[a];if(!1===n.call(t,e[s],s,a,u))break}}var h=/(\n|\r)?[\s\xA0]+$/;function _(){}function P(e,n,t){if(!e)switch(t){case"ex":throw Error(i+'Extension tag "'+n+'" is undefined, please check it has been registered.');default:throw Error(i+(n||e))}}function w(e,n){switch(n){case"f":e='A filter called "'+e+'" is undefined.'}console.warn(i+e)}function C(){return Object.create(null)}var O=/["]+/g,E=/[']+/g;function S(e){return-1<e.indexOf("-")&&(e=e.replace(/-\w/g,function(e){return e.substr(1).toUpperCase()})),e}var k=Object.assign||function(e){for(var n=1,t=arguments;n<t.length;n++){var r=t[n];for(var o in r)l.call(r,o)&&(e[o]=r[o])}return e};function A(e){return e[0].toUpperCase()+e.substr(1)}k(a,{defineProp:u,defineProps:p,arrayPush:f,arraySlice:c,isArray:v,isObject:d,isNumber:m,isString:y,isArrayLike:g,each:j,noop:_,throwIf:P,warn:w,obj:C,toCamelCase:S,assign:k,capitalize:A});var G=Object.freeze({defineProp:u,defineProps:p,arrayPush:f,arraySlice:c,isArray:v,isObject:d,isNumber:m,isString:y,isArrayLike:g,each:j,trimRight:function(e){return e.replace(h,function(e,n){return n?"\n":""})},noop:_,throwIf:P,warn:w,error:function(e){console.error(i+e)},obj:C,clearQuot:function(e,n){if(null!=e){var t;if(null==n){var r=e[0];"'"===r?t=E:'"'===r&&(t=O)}else t=n?O:E;return t&&(e=e.replace(t,"")),e}},toCamelCase:S,assign:k,capitalize:A}),N=a.components,T=a.componentConfig;function H(e,n,t){var u,r=e;return d(e)||((r={})[e]={component:n,options:t}),j(r,function(e,n,t){var r;if(null!=e){var o=e.component,l=e.options,i=n.toLowerCase();T.set(N[i]=r=o||e,l)}0==t?u=r:(1==t&&(u=[u]),u.push(r))},!1,!1),u}var I={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},R=/[&><"']/g;var L={nbsp:" ",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lt:"<",gt:">",amp:"&",quot:'"',"#x27":"'"},K=RegExp("&("+Object.keys(L).join("|")+");","g");k(a,{escape:function(e){return null==e?"":e.replace?e.replace(R,function(e){return I[e]}):e},unescape:function(e){return null==e?"":e.replace?e.replace(K,function(e,n){return L[n]}):e}});var z=/^(-?([0-9]+[\.]?[0-9]+)|[0-9])$/;function D(e){if(d(e)||v(e)||m(e))return e;for(var n,t,r=/([^\s:]+)[\s]?:[\s]?([^;]+)[;]?/g;n=r.exec(e);){var o=n[1],l=n[2];t||(t={}),/^[A-Z-]+$/.test(o)&&(o=o.toLowerCase()),t[o=S(o)]=z.test(l)?+l:l}return t}function F(e,n,t){var r,o;n||(n=this.data);for(var l=0,i=n.length;l<i;l++)if((o=n[l])&&void 0!==(r=o[e]))return t?{_njCtx:o,val:r,prop:e}:r}function M(e,n){return null!=e&&null!=n.level&&(e+=n.level),e}function U(e,n,t){return null==e?e:e.val._njTmpl?e.val.call({_njData:n.data,_njParent:n.parent,_njIndex:n.index,_njLevel:M(t,n),_njIcp:n.icp}):e.val.call(n.data[n.data.length-1],n)}function J(e,n,t,r,o){var l;return r.icp&&(l=F(t,r.icp))||(l=n.cp[e]),null!=o&&l&&(l=l[o]),l||t}function W(e,n,t,r,o){return null!=e?y(e)?J(e.toLowerCase(),t,e,o):e:J(n,t,r,o)}function $(e,n){return null!=e&&""!==e?e:n}function q(e,n){var t=e.args;if(t)for(var r=t.length;r--;)n.unshift(t[r])}function Q(e,n){return n?{data:n.data?f(n.data,e.data):e.data,parent:n.fallback?e:e.parent,root:e.root||e,index:"index"in n?n.index:e.index,item:"item"in n?n.item:e.item,level:e.level,getData:F,d:F,icp:e.icp}:e}function X(){var e="",n=k.apply(G,arguments);for(var t in n){var r=n[t];e+=" "+t+(t!==r?'="'+r+'"':" ")}return e}function Z(n,t,r,o,l){return function(e){return r(n,t,e,o,l)}}function B(o,l){return function(e,n){var t=this,r=c(arguments);return l(o,{data:t&&t._njData?f(r,t._njData):r,parent:t?t._njParent:null,index:t?t._njIndex:null,item:t?t._njItem:null,level:t?t._njLevel:null,getData:F,d:F,icp:function(e,n){var t;return e&&e.components&&(v(t=e.components)||(t=[t])),n&&n._njIcp&&(t=t?f(t,n._njIcp):n._njIcp),t}(e&&e._njParam?n:e,t)})}}function V(e){if(null==e.level)return"";for(var n="",t=0;t<e.level;t++)n+="  ";return n}function Y(e){return null==e.index?"":0==e.index?"":"\n"}function ee(e){return a.createElement.apply(null,e)}function ne(e){return e._njCtx?e.val.bind(e._njCtx):e}var te={if:function(e,n){var t;if(e&&e._njOpts&&(e=(n=e).props.condition),"false"===e&&(e=!1),n.useUnless?!e:!!e)t=n.result();else{var r=n.props;if(r){var o=r.else;if(r.elseifs){var l=r.elseifs.length;j(r.elseifs,function(e,n){if(e.value)return t=e.fn(),!1;n===l-1&&o&&(t=o())},!1,!0)}else o&&(t=o())}}return n.useString&&null==t?"":t},else:function(e){return e.subExProps.else=e.result},elseif:function(e,n){e&&e._njOpts&&(e=(n=e).props.condition||n.props.value);var t=n.subExProps;t.elseifs||(t.elseifs=[]),t.elseifs.push({value:e,fn:n.result})},switch:function(t,e){t&&t._njOpts&&(t=(e=t).props.value);var r,o=e.props,l=o.elseifs.length;return j(o.elseifs,function(e,n){if(t===e.value)return r=e.fn(),!1;n===l-1&&o.else&&(r=o.else())},!1,!0),r},unless:function(e,n){return n.useUnless=!0,te.if(e,n)},each:function(e,u){e&&e._njOpts&&(e=(u=e).props.of);var a,s=u.useString,n=u.props;if(e){a=s?"":[];var p=g(e);j(e,function(e,n,t,r){var o,l={data:[e],index:p?n:t,item:e,fallback:!0};o={"@first":0===l.index,"@last":l.index===(p?t:r)-1},p||(o||(o={}),o["@key"]=n),o&&l.data.push(o);var i=u.result(l);s?a+=i:a.push(i)},!1,p),s||a.length||(a=null),a&&a.length||!n||!n.else||(a=n.else())}else n&&n.else&&(a=n.else()),s&&null==a&&(a="");return a},prop:function(e,n){var t,r=n.result();t=void 0!==r?r:!n.useString||e,n.exProps[n.outputH?function(e){switch(e){case"class":e="className";break;case"for":e="htmlFor"}return e}(e):e]=t},spread:function(e,t){j(e,function(e,n){t.exProps[n]=e},!1,!1)},show:function(e){if(!e.result()){var n=e.attrs,t=e.useString;n.style||(n.style=t?"":{}),t?n.style+=(n.style?";":"")+"display:none":v(n.style)?n.style.push({display:"none"}):n.style.display="none"}},for:function(t,r,e){var o,l=1;if(t&&t._njOpts){var i=(e=t).props;Object.keys(i).forEach(function(e){var n=i[e];"to"===e?r=n:"step"===e?l=n:(t=n,o=e)})}else e.props&&(l=e.props.step||1);var n,u=e.useString;for(n=u?"":[];t<=r;t+=l){var a=e.result({data:o?[s({},o,t)]:null,index:t,fallback:!0});u?n+=a:n.push(a)}return n},obj:function(e){return e.props},list:function(){var e=arguments,n=e.length-1,t=e[n];if(0<n){var r=c(e,0,n);return t.useString&&(r=r.join("")),r}return[t.result()]},fn:function(e){var n=e.props;return function(){var t,r=arguments;if(n){t={};var o=Object.keys(n);o.forEach(function(e,n){return t[o[n]]=r[n]})}return e.result({data:[t]})}},block:function(e){return e.result()},pre:function(e){return te.block(e)},with:function(e,n){if(e&&e._njOpts)return(n=e).result({data:[n.props]});var t=n.props;return n.result({data:[t&&t.as?s({},t.as,e):e]})},arg:function(e){var n=e.exProps;n.args||(n.args=[]),n.args.push(e.result())},once:function(e){var n=e.context.root||e.context,t=e.props,r=t&&t.name?t.name:"_njOnceCache_"+e.exNo,o=n[r];return void 0===o&&(o=n[r]=e.result()),o},css:function(e){return e.props.style}};function re(e,n){var t={onlyGlobal:!1,useString:!1,newContext:!0,exProps:!1,isProp:!1,subExProps:!1,isSub:!1,addSet:!1,useExpressionInJsx:"onlyTemplateLiteral"};return e&&(t=k(t,e)),n&&(t=k(t,n)),t}var oe={onlyGlobal:!0,newContext:!1},le={if:re(oe),else:re({onlyGlobal:!0,newContext:!1,subExProps:!0,isSub:!0}),switch:re(oe,{needPrefix:"onlyUpperCase"}),unless:re(oe),each:re({onlyGlobal:!0,newContext:{item:"item",index:"index",datas:{first:["@first","first"],last:["@last","last"]}}}),for:re({onlyGlobal:!0,newContext:{index:"index",getDatasFromProp:{except:["to","step","index"]}}}),prop:re({onlyGlobal:!0,newContext:!1,exProps:!0,subExProps:!0,isProp:!0}),spread:re({onlyGlobal:!0,newContext:!1,exProps:!0,subExProps:!0,isProp:!0}),obj:re({onlyGlobal:!0,newContext:!1}),list:re(oe,{needPrefix:"onlyUpperCase"}),with:re({onlyGlobal:!0,newContext:{getDatasFromProp:!0}}),style:{useExpressionInJsx:!1,needPrefix:!0}};function ie(e,n,t,o){var r=e;d(e)||((r={})[e]={extension:n,options:t}),j(r,function(e,n){if(e){var t=e.extension,r=e.options;t?te[n]=t:o||(te[n]=e),o?(le[n]||(le[n]={}),k(le[n],r)):le[n]=re(r)}},!1,!1)}le.elseif=re(le.else),le.fn=re(le.with),le.block=re(le.obj),le.pre=re(le.obj,{needPrefix:!0}),le.arg=re(le.prop),le.once=re(le.obj),le.show=re(le.prop),le.css=re(le.obj),te.case=te.elseif,le.case=le.elseif,te.empty=te.default=te.else,le.empty=le.default=le.else,te.strProp=te.prop,le.strProp=re(le.prop,{useString:!0}),te.strArg=te.arg,le.strArg=re(le.strProp),k(a,{extensions:te,extensionConfig:le,registerExtension:ie});var ue={".":function(e,n,t){return null==e?e:e._njCtx?{_njCtx:e.val,val:e.val[n],prop:n}:t?{obj:e,prop:n}:e[n]},_:function(e,n){return e&&null!=e.obj[e.prop]?e.obj[e.prop].apply(e.obj,n):null},"#":function(e,n,t){return null==e?e:U({val:e[n],_njCtx:e},t.context,t.level)},"**":function(e,n){return Math.pow(e,n)},"%%":function(e,n){return Math.floor(e/n)},"?:":function(e,n,t){return e?n:t},"!":function(e){return!e},int:function(e){return parseInt(e,10)},float:function(e){return parseFloat(e)},bool:function(e){return"false"!==e&&!!e},reg:function(e,n){return RegExp(e,n)},css:function(e){return D(e)},"..":ae(1),rLt:ae(0),"<=>":function(e,n){return n<e?1:e==n?0:-1},capitalize:function(e){return A(e)}};function ae(t){return function(n,e){return Object.keys(Array.apply(null,{length:e-n+t})).map(function(e){return+e+n})}}function se(e){var n={onlyGlobal:!1,hasOptions:!0};return e&&(n=k(n,e)),n}var pe={onlyGlobal:!0,hasOptions:!1},fe={".":se(pe),_:se({onlyGlobal:!0}),"#":se({onlyGlobal:!0}),"**":se(pe),"%%":se(pe),"?:":se(pe),"!":se(pe),int:se(pe),float:se(pe),bool:se(pe),reg:se(pe),css:se(pe),"..":se(pe),rLt:se(pe),"<=>":se(pe),capitalize:se(pe)};ue.prop=ue["."],fe.prop=fe["."];var ce=/\*|\||\/|\.|\?|\+/g;function ve(e,n,t,o){var r=e;d(e)||((r={})[e]={filter:n,options:t}),j(r,function(e,n){if(e){var t=e.filter,r=e.options;t?ue[n]=t:o||(ue[n]=e),o?(fe[n]||(fe[n]={}),k(fe[n],r)):fe[n]=se(r)}},!1,!1)}function de(e){return function(e,n,t,r,o){if(e){if(d(n)){var l=n;n=l.tmplKey,l.fileName,l.delimiters,l.tmplRule}var i,u;if(n&&(i=a.templates[n]),!i)d(e)&&e.main&&(u=e),i=function(e,n){var t={tmplKey:n,us:e.useString,x:a.extensions,f:a.filters,np:_,tf:P,wn:w,n:Q,c:U,sp:D,r:Z,e:J,er:W,en:$,aa:q,an:k,g:a.global,l:M,cf:ne};return t.us?(t.ans=X,t.es=a.escape,t.ls=V,t.fl=Y):(t.h=a.createElement,t.H=ee,t.cp=a.components),j(e,function(e,n){0==n.indexOf("main")?(t[n]=B(t,e),p(t[n],{_njTmpl:{value:!0},tmplName:{value:e._njName}}),t["_"+n]=e):0==n.indexOf("fn")&&(t[n]=e)},!1,!1),t}(u),n&&(a.templates[n]=i);return i.main}}}a.REGEX_OPERATORS=RegExp(["+=","+","-[0-9]","-","**","*","%%","%","===","!==","==","!=","<=>","<=",">=","=","..<","<",">","&&","||","?:","?",":","../","..","/"].map(function(e){return e.replace(ce,function(e){return"\\"+e})}).join("|"),"g"),k(a,{filters:ue,filterConfig:fe,registerFilter:ve});var me=de(),ye=de();function be(t){return function(e,n){return(t?ye:me)(e,n?{tmplKey:n.tmplKey?n.tmplKey:e._njTmplKey,fileName:n.fileName,delimiters:n.delimiters}:e._njTmplKey).apply(null,c(arguments,1))}}var xe=be(),ge=be(!0);function je(o){return function(e,n){var t=(o?ye:me)(e,e._njTmplKey);if(n){var r=function(){return t.apply(this,f([n],arguments))};return u(n,"_njParam",{value:!0}),p(r,{_njTmpl:{value:!0}}),r}return t}}var he=je(),_e=je(!0);k(a,{compile:me,compileH:ye,render:xe,renderH:ge,buildRender:he,buildRenderH:_e}),k(a,{registerComponent:H,getComponentConfig:function(e){return T.get(y(e)?N[e]:e)},config:function(e){var n=e.createElement,t=e.outputH;n&&(a.createElement=n),null!=t&&(a.outputH=t)}});var Pe=a.global;Pe.NornJ=Pe.nj=a,e.compile=me,e.compileH=ye,e.default=a,e.registerComponent=H,e.registerExtension=ie,e.registerFilter=ve,e.render=xe,e.renderH=ge,Object.defineProperty(e,"__esModule",{value:!0})});
